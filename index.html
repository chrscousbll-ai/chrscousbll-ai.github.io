// Vegetation selection
function selectVegetation(type) {
  currentVegType = type;

  // Stop the previous line so the new type starts fresh
  currentLine = null;

  // Initialize storage for this type if needed
  if (!lines[currentVegType]) lines[currentVegType] = [];

  // Highlight the selected button
  document.querySelectorAll('.button-bar button').forEach(btn => btn.classList.remove('highlight'));
  const btnId = type === 'deadTree' ? 'btnDeadTree' : 'btn' + type.charAt(0).toUpperCase() + type.slice(1);
  document.getElementById(btnId).classList.add('highlight');
}

// Add GPS point
function addGPSPoint(lat, lng) {
  if (!currentVegType) return; // no type selected

  if (currentVegType === 'deadTree') {
    // Place a dead tree marker (single click only)
    const marker = L.marker([lat, lng]).addTo(map).bindPopup("Dead Tree");
    deadTrees.push(marker);
  } else {
    // Draw line for selected vegetation type
    if (!currentLine) {
      currentLine = L.polyline([[lat, lng]], { color: vegColors[currentVegType], weight: 5 }).addTo(map);
      lines[currentVegType].push(currentLine);
    } else {
      currentLine.addLatLng([lat, lng]);
    }
  }
}
